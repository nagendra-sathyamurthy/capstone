{
	"info": {
		"_postman_id": "auth-service-collection",
		"name": "Authentication Service Collection v2.0.0",
		"description": "Comprehensive Authentication Service API collection for JWT-based authentication, user management, and role-based authorization testing",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"version": "2.0.0"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{auth_token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"exec": [
					"// Set dynamic variables for testing",
					"pm.globals.set('timestamp', Date.now());",
					"pm.globals.set('random_email', 'user' + Date.now() + '@test.com');",
					"pm.globals.set('random_phone', '+1' + Math.floor(Math.random() * 9000000000 + 1000000000));"
				],
				"type": "text/javascript"
			}
		},
		{
			"listen": "test",
			"script": {
				"exec": [
					"// Global test script for all requests",
					"pm.test('Response time is reasonable (< 5s)', function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(5000);",
					"});",
					"",
					"// Log response for debugging",
					"console.log('ðŸ” Status:', pm.response.status);",
					"console.log('â±ï¸ Response Time:', pm.response.responseTime + 'ms');"
				],
				"type": "text/javascript"
			}
		}
	],
	"item": [
		{
			"name": "ðŸ” Authentication Flow",
			"description": "Basic authentication endpoints for login and registration",
			"item": [
				{
					"name": "Register New User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 201', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"",
									"if (pm.response.code === 200 || pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.userId) {",
									"        pm.environment.set('test_user_id', responseJson.userId);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{random_email}}\",\n  \"password\": \"TestPassword123!\",\n  \"firstName\": \"Test\",\n  \"lastName\": \"User\",\n  \"phoneNumber\": \"{{random_phone}}\",\n  \"role\": \"Customer\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/register",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Response has JWT token', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('token');",
									"    pm.expect(responseJson.token).to.be.a('string');",
									"});",
									"",
									"// Store the token for subsequent requests",
									"if (pm.response.code === 200) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('auth_token', responseJson.token);",
									"    if (responseJson.user && responseJson.user.id) {",
									"        pm.environment.set('current_user_id', responseJson.user.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/login",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Validate Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Token is valid', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson.valid).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{auth_base_url}}/api/auth/validate",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"validate"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ðŸ‘¤ User Profile Management",
			"description": "User profile and password management endpoints",
			"item": [
				{
					"name": "Get User Profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Response has user data', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('email');",
									"    pm.expect(responseJson).to.have.property('role');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{auth_base_url}}/api/auth/profile",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"currentPassword\": \"{{admin_password}}\",\n  \"newPassword\": \"NewPassword123!\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/password",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"password"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ðŸ”’ Authorization & Permissions",
			"description": "Role and permission management endpoints",
			"item": [
				{
					"name": "Get All Roles",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Response contains roles array', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{auth_base_url}}/api/auth/roles",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"roles"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Role Permissions",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Response contains permissions array', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{auth_base_url}}/api/auth/permissions/Customer",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"permissions",
								"Customer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Check Permission",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"pm.test('Response has permission check result', function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('hasPermission');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "\"order_food\""
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/check-permission",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"check-permission"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ðŸ“± OTP Management",
			"description": "OTP generation and verification endpoints",
			"item": [
				{
					"name": "Generate OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.otp) {",
									"        pm.environment.set('test_otp', responseJson.otp);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"purpose\": \"login\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/generate-otp",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"generate-otp"
							]
						}
					},
					"response": []
				},
				{
					"name": "Verify OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"otp\": \"{{test_otp}}\",\n  \"purpose\": \"login\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/verify-otp",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"verify-otp"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ðŸšª Alternative Login Methods",
			"description": "Email-based login options",
			"item": [
				{
					"name": "Login with Email/Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.token) {",
									"        pm.environment.set('auth_token', responseJson.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/login/email",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								"email"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login with Email/OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.token) {",
									"        pm.environment.set('auth_token', responseJson.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"otp\": \"{{test_otp}}\"\n}"
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/login/email-otp",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								"email-otp"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ðŸ”“ Password Recovery",
			"description": "Password reset functionality",
			"item": [
				{
					"name": "Forgot Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.expect(pm.response.code).to.eql(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "\"{{admin_email}}\""
						},
						"url": {
							"raw": "{{auth_base_url}}/api/auth/forgot-password",
							"host": [
								"{{auth_base_url}}"
							],
							"path": [
								"api",
								"auth",
								"forgot-password"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}